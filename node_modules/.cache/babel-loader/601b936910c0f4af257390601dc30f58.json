{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _objectSpread2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectSpread\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _format = _interopRequireDefault(require(\"date-fns/format\"));\n\nvar _2 = require(\"./\");\n\nvar DataManager = /*#__PURE__*/function () {\n  function DataManager() {\n    var _this = this;\n\n    (0, _classCallCheck2[\"default\"])(this, DataManager);\n    (0, _defineProperty2[\"default\"])(this, \"applyFilters\", false);\n    (0, _defineProperty2[\"default\"])(this, \"applySearch\", false);\n    (0, _defineProperty2[\"default\"])(this, \"applySort\", false);\n    (0, _defineProperty2[\"default\"])(this, \"currentPage\", 0);\n    (0, _defineProperty2[\"default\"])(this, \"detailPanelType\", \"multiple\");\n    (0, _defineProperty2[\"default\"])(this, \"lastDetailPanelRow\", undefined);\n    (0, _defineProperty2[\"default\"])(this, \"lastEditingRow\", undefined);\n    (0, _defineProperty2[\"default\"])(this, \"orderBy\", -1);\n    (0, _defineProperty2[\"default\"])(this, \"orderDirection\", \"\");\n    (0, _defineProperty2[\"default\"])(this, \"pageSize\", 5);\n    (0, _defineProperty2[\"default\"])(this, \"paging\", true);\n    (0, _defineProperty2[\"default\"])(this, \"parentFunc\", null);\n    (0, _defineProperty2[\"default\"])(this, \"searchText\", \"\");\n    (0, _defineProperty2[\"default\"])(this, \"selectedCount\", 0);\n    (0, _defineProperty2[\"default\"])(this, \"treefiedDataLength\", 0);\n    (0, _defineProperty2[\"default\"])(this, \"treeDataMaxLevel\", 0);\n    (0, _defineProperty2[\"default\"])(this, \"groupedDataLength\", 0);\n    (0, _defineProperty2[\"default\"])(this, \"defaultExpanded\", false);\n    (0, _defineProperty2[\"default\"])(this, \"bulkEditOpen\", false);\n    (0, _defineProperty2[\"default\"])(this, \"bulkEditChangedRows\", {});\n    (0, _defineProperty2[\"default\"])(this, \"data\", []);\n    (0, _defineProperty2[\"default\"])(this, \"columns\", []);\n    (0, _defineProperty2[\"default\"])(this, \"filteredData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"searchedData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"groupedData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"treefiedData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"sortedData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"pagedData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"renderData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"filtered\", false);\n    (0, _defineProperty2[\"default\"])(this, \"searched\", false);\n    (0, _defineProperty2[\"default\"])(this, \"grouped\", false);\n    (0, _defineProperty2[\"default\"])(this, \"treefied\", false);\n    (0, _defineProperty2[\"default\"])(this, \"sorted\", false);\n    (0, _defineProperty2[\"default\"])(this, \"paged\", false);\n    (0, _defineProperty2[\"default\"])(this, \"rootGroupsIndex\", {});\n    (0, _defineProperty2[\"default\"])(this, \"startCellEditable\", function (rowData, columnDef) {\n      rowData.tableData.editCellList = [].concat((0, _toConsumableArray2[\"default\"])(rowData.tableData.editCellList || []), [columnDef]);\n    });\n    (0, _defineProperty2[\"default\"])(this, \"finishCellEditable\", function (rowData, columnDef) {\n      if (rowData.tableData.editCellList) {\n        var index = rowData.tableData.editCellList.findIndex(function (c) {\n          return c.tableData.id === columnDef.tableData.id;\n        });\n\n        if (index !== -1) {\n          rowData.tableData.editCellList.splice(index, 1);\n        }\n      }\n    });\n    (0, _defineProperty2[\"default\"])(this, \"clearBulkEditChangedRows\", function () {\n      _this.bulkEditChangedRows = {};\n    });\n    (0, _defineProperty2[\"default\"])(this, \"onBulkEditRowChanged\", function (oldData, newData) {\n      _this.bulkEditChangedRows[oldData.tableData.id] = {\n        oldData: oldData,\n        newData: newData\n      };\n    });\n    (0, _defineProperty2[\"default\"])(this, \"expandTreeForNodes\", function (data) {\n      data.forEach(function (row) {\n        var currentRow = row;\n\n        while (_this.parentFunc(currentRow, _this.data)) {\n          var parent = _this.parentFunc(currentRow, _this.data);\n\n          if (parent) {\n            parent.tableData.isTreeExpanded = true;\n          }\n\n          currentRow = parent;\n        }\n      });\n    });\n    (0, _defineProperty2[\"default\"])(this, \"findDataByPath\", function (renderData, path) {\n      if (_this.isDataType(\"tree\")) {\n        var node = path.reduce(function (result, current) {\n          return result && result.tableData && result.tableData.childRows && result.tableData.childRows[current];\n        }, {\n          tableData: {\n            childRows: renderData\n          }\n        });\n        return node;\n      } else {\n        var data = {\n          groups: renderData\n        };\n\n        var _node = path.reduce(function (result, current) {\n          if (result.groups.length > 0) {\n            return result.groups[current];\n          } else if (result.data) {\n            return result.data[current];\n          } else {\n            return undefined;\n          }\n        }, data);\n\n        return _node;\n      }\n    });\n    (0, _defineProperty2[\"default\"])(this, \"getFieldValue\", function (rowData, columnDef) {\n      var lookup = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      var value = typeof rowData[columnDef.field] !== \"undefined\" ? rowData[columnDef.field] : (0, _2.byString)(rowData, columnDef.field);\n\n      if (columnDef.lookup && lookup) {\n        value = columnDef.lookup[value];\n      }\n\n      return value;\n    });\n    (0, _defineProperty2[\"default\"])(this, \"getRenderState\", function () {\n      if (_this.filtered === false) {\n        _this.filterData();\n      }\n\n      if (_this.searched === false) {\n        _this.searchData();\n      }\n\n      if (_this.grouped === false && _this.isDataType(\"group\")) {\n        _this.groupData();\n      }\n\n      if (_this.treefied === false && _this.isDataType(\"tree\")) {\n        _this.treefyData();\n      }\n\n      if (_this.sorted === false) {\n        _this.sortData();\n      }\n\n      if (_this.paged === false) {\n        _this.pageData();\n      }\n\n      return {\n        columns: _this.columns,\n        currentPage: _this.currentPage,\n        data: _this.sortedData,\n        lastEditingRow: _this.lastEditingRow,\n        orderBy: _this.orderBy,\n        orderDirection: _this.orderDirection,\n        originalData: _this.data,\n        pageSize: _this.pageSize,\n        renderData: _this.pagedData,\n        searchText: _this.searchText,\n        selectedCount: _this.selectedCount,\n        treefiedDataLength: _this.treefiedDataLength,\n        treeDataMaxLevel: _this.treeDataMaxLevel,\n        groupedDataLength: _this.groupedDataLength\n      };\n    });\n    (0, _defineProperty2[\"default\"])(this, \"filterData\", function () {\n      _this.searched = _this.grouped = _this.treefied = _this.sorted = _this.paged = false;\n      _this.filteredData = (0, _toConsumableArray2[\"default\"])(_this.data);\n\n      if (_this.applyFilters) {\n        _this.columns.filter(function (columnDef) {\n          return columnDef.tableData.filterValue;\n        }).forEach(function (columnDef) {\n          var lookup = columnDef.lookup,\n              type = columnDef.type,\n              tableData = columnDef.tableData;\n\n          if (columnDef.customFilterAndSearch) {\n            _this.filteredData = _this.filteredData.filter(function (row) {\n              return !!columnDef.customFilterAndSearch(tableData.filterValue, row, columnDef);\n            });\n          } else {\n            if (lookup) {\n              _this.filteredData = _this.filteredData.filter(function (row) {\n                var value = _this.getFieldValue(row, columnDef, false);\n\n                return !tableData.filterValue || tableData.filterValue.length === 0 || tableData.filterValue.indexOf(value !== undefined && value !== null && value.toString()) > -1;\n              });\n            } else if (type === \"numeric\") {\n              _this.filteredData = _this.filteredData.filter(function (row) {\n                var value = _this.getFieldValue(row, columnDef);\n\n                return value + \"\" === tableData.filterValue;\n              });\n            } else if (type === \"boolean\" && tableData.filterValue) {\n              _this.filteredData = _this.filteredData.filter(function (row) {\n                var value = _this.getFieldValue(row, columnDef);\n\n                return value && tableData.filterValue === \"checked\" || !value && tableData.filterValue === \"unchecked\";\n              });\n            } else if ([\"date\", \"datetime\"].includes(type)) {\n              _this.filteredData = _this.filteredData.filter(function (row) {\n                var value = _this.getFieldValue(row, columnDef);\n\n                var currentDate = value ? new Date(value) : null;\n\n                if (currentDate && currentDate.toString() !== \"Invalid Date\") {\n                  var selectedDate = tableData.filterValue;\n                  var currentDateToCompare = \"\";\n                  var selectedDateToCompare = \"\";\n\n                  if (type === \"date\") {\n                    currentDateToCompare = (0, _format[\"default\"])(currentDate, \"MM/dd/yyyy\");\n                    selectedDateToCompare = (0, _format[\"default\"])(selectedDate, \"MM/dd/yyyy\");\n                  } else if (type === \"datetime\") {\n                    currentDateToCompare = (0, _format[\"default\"])(currentDate, \"MM/dd/yyyy - HH:mm\");\n                    selectedDateToCompare = (0, _format[\"default\"])(selectedDate, \"MM/dd/yyyy - HH:mm\");\n                  }\n\n                  return currentDateToCompare === selectedDateToCompare;\n                }\n\n                return true;\n              });\n            } else if (type === \"time\") {\n              _this.filteredData = _this.filteredData.filter(function (row) {\n                var value = _this.getFieldValue(row, columnDef);\n\n                var currentHour = value || null;\n\n                if (currentHour) {\n                  var selectedHour = tableData.filterValue;\n                  var currentHourToCompare = (0, _format[\"default\"])(selectedHour, \"HH:mm\");\n                  return currentHour === currentHourToCompare;\n                }\n\n                return true;\n              });\n            } else {\n              _this.filteredData = _this.filteredData.filter(function (row) {\n                var value = _this.getFieldValue(row, columnDef);\n\n                return value && value.toString().toUpperCase().includes(tableData.filterValue.toUpperCase());\n              });\n            }\n          }\n        });\n      }\n\n      _this.filtered = true;\n    });\n    (0, _defineProperty2[\"default\"])(this, \"searchData\", function () {\n      _this.grouped = _this.treefied = _this.sorted = _this.paged = false;\n      _this.searchedData = (0, _toConsumableArray2[\"default\"])(_this.filteredData);\n\n      if (_this.searchText && _this.applySearch) {\n        _this.searchedData = _this.searchedData.filter(function (row) {\n          return _this.columns.filter(function (columnDef) {\n            return columnDef.searchable === undefined ? !columnDef.hidden : columnDef.searchable;\n          }).some(function (columnDef) {\n            if (columnDef.customFilterAndSearch) {\n              return !!columnDef.customFilterAndSearch(_this.searchText, row, columnDef);\n            } else if (columnDef.field) {\n              var value = _this.getFieldValue(row, columnDef);\n\n              if (value) {\n                return value.toString().toUpperCase().includes(_this.searchText.toUpperCase());\n              }\n            }\n          });\n        });\n      }\n\n      _this.searched = true;\n    });\n  }\n\n  (0, _createClass2[\"default\"])(DataManager, [{\n    key: \"setData\",\n    value: function setData(data) {\n      var _this2 = this;\n\n      this.selectedCount = 0;\n      this.data = data.map(function (row, index) {\n        row.tableData = (0, _objectSpread2[\"default\"])({}, row.tableData, {\n          id: index\n        });\n\n        if (row.tableData.checked) {\n          _this2.selectedCount++;\n        }\n\n        return row;\n      });\n      this.filtered = false;\n    }\n  }, {\n    key: \"setColumns\",\n    value: function setColumns(columns) {\n      var undefinedWidthColumns = columns.filter(function (c) {\n        return c.width === undefined && !c.hidden;\n      });\n      var usedWidth = [\"0px\"];\n      this.columns = columns.map(function (columnDef, index) {\n        columnDef.tableData = (0, _objectSpread2[\"default\"])({\n          columnOrder: index,\n          filterValue: columnDef.defaultFilter,\n          groupOrder: columnDef.defaultGroupOrder,\n          groupSort: columnDef.defaultGroupSort || \"asc\",\n          width: columnDef.width\n        }, columnDef.tableData, {\n          id: index\n        });\n\n        if (columnDef.width !== undefined) {\n          if (typeof columnDef.width === \"number\") {\n            usedWidth.push(columnDef.width + \"px\");\n          } else {\n            usedWidth.push(columnDef.width);\n          }\n        }\n\n        return columnDef;\n      });\n      usedWidth = \"(\" + usedWidth.join(\" + \") + \")\";\n      undefinedWidthColumns.forEach(function (columnDef) {\n        columnDef.tableData.width = \"calc((100% - \".concat(usedWidth, \") / \").concat(undefinedWidthColumns.length, \")\");\n      });\n    }\n  }, {\n    key: \"setDefaultExpanded\",\n    value: function setDefaultExpanded(expanded) {\n      this.defaultExpanded = expanded;\n    }\n  }, {\n    key: \"changeApplySearch\",\n    value: function changeApplySearch(applySearch) {\n      this.applySearch = applySearch;\n      this.searched = false;\n    }\n  }, {\n    key: \"changeApplyFilters\",\n    value: function changeApplyFilters(applyFilters) {\n      this.applyFilters = applyFilters;\n      this.filtered = false;\n    }\n  }, {\n    key: \"changeApplySort\",\n    value: function changeApplySort(applySort) {\n      this.applySort = applySort;\n      this.sorted = false;\n    }\n  }, {\n    key: \"changePaging\",\n    value: function changePaging(paging) {\n      this.paging = paging;\n      this.paged = false;\n    }\n  }, {\n    key: \"changeCurrentPage\",\n    value: function changeCurrentPage(currentPage) {\n      this.currentPage = currentPage;\n      this.paged = false;\n    }\n  }, {\n    key: \"changePageSize\",\n    value: function changePageSize(pageSize) {\n      this.pageSize = pageSize;\n      this.paged = false;\n    }\n  }, {\n    key: \"changeParentFunc\",\n    value: function changeParentFunc(parentFunc) {\n      this.parentFunc = parentFunc;\n    }\n  }, {\n    key: \"changeFilterValue\",\n    value: function changeFilterValue(columnId, value) {\n      this.columns[columnId].tableData.filterValue = value;\n      this.filtered = false;\n    }\n  }, {\n    key: \"changeRowSelected\",\n    value: function changeRowSelected(checked, path) {\n      var _this3 = this;\n\n      var rowData = this.findDataByPath(this.sortedData, path);\n      rowData.tableData.checked = checked;\n      this.selectedCount = this.selectedCount + (checked ? 1 : -1);\n\n      var checkChildRows = function checkChildRows(rowData) {\n        if (rowData.tableData.childRows) {\n          rowData.tableData.childRows.forEach(function (childRow) {\n            if (childRow.tableData.checked !== checked) {\n              childRow.tableData.checked = checked;\n              _this3.selectedCount = _this3.selectedCount + (checked ? 1 : -1);\n            }\n\n            checkChildRows(childRow);\n          });\n        }\n      };\n\n      checkChildRows(rowData);\n      this.filtered = false;\n    }\n  }, {\n    key: \"changeDetailPanelVisibility\",\n    value: function changeDetailPanelVisibility(path, render) {\n      var rowData = this.findDataByPath(this.sortedData, path);\n\n      if ((rowData.tableData.showDetailPanel || \"\").toString() === render.toString()) {\n        rowData.tableData.showDetailPanel = undefined;\n      } else {\n        rowData.tableData.showDetailPanel = render;\n      }\n\n      if (this.detailPanelType === \"single\" && this.lastDetailPanelRow && this.lastDetailPanelRow != rowData) {\n        this.lastDetailPanelRow.tableData.showDetailPanel = undefined;\n      }\n\n      this.lastDetailPanelRow = rowData;\n    }\n  }, {\n    key: \"changeGroupExpand\",\n    value: function changeGroupExpand(path) {\n      var rowData = this.findDataByPath(this.sortedData, path);\n      rowData.isExpanded = !rowData.isExpanded;\n    }\n  }, {\n    key: \"changeSearchText\",\n    value: function changeSearchText(searchText) {\n      this.searchText = searchText;\n      this.searched = false;\n      this.currentPage = 0;\n    }\n  }, {\n    key: \"changeRowEditing\",\n    value: function changeRowEditing(rowData, mode) {\n      if (rowData) {\n        rowData.tableData.editing = mode;\n\n        if (this.lastEditingRow && this.lastEditingRow != rowData) {\n          this.lastEditingRow.tableData.editing = undefined;\n        }\n\n        if (mode) {\n          this.lastEditingRow = rowData;\n        } else {\n          this.lastEditingRow = undefined;\n        }\n      } else if (this.lastEditingRow) {\n        this.lastEditingRow.tableData.editing = undefined;\n        this.lastEditingRow = undefined;\n      }\n    }\n  }, {\n    key: \"changeBulkEditOpen\",\n    value: function changeBulkEditOpen(bulkEditOpen) {\n      this.bulkEditOpen = bulkEditOpen;\n    }\n  }, {\n    key: \"changeAllSelected\",\n    value: function changeAllSelected(checked) {\n      var selectedCount = 0;\n\n      if (this.isDataType(\"group\")) {\n        var setCheck = function setCheck(data) {\n          data.forEach(function (element) {\n            if (element.groups.length > 0) {\n              setCheck(element.groups);\n            } else {\n              element.data.forEach(function (d) {\n                d.tableData.checked = d.tableData.disabled ? false : checked;\n                selectedCount++;\n              });\n            }\n          });\n        };\n\n        setCheck(this.groupedData);\n      } else {\n        this.searchedData.map(function (row) {\n          row.tableData.checked = row.tableData.disabled ? false : checked;\n          return row;\n        });\n        selectedCount = this.searchedData.length;\n      }\n\n      this.selectedCount = checked ? selectedCount : 0;\n    }\n  }, {\n    key: \"changeOrder\",\n    value: function changeOrder(orderBy, orderDirection) {\n      this.orderBy = orderBy;\n      this.orderDirection = orderDirection;\n      this.currentPage = 0;\n      this.sorted = false;\n    }\n  }, {\n    key: \"changeGroupOrder\",\n    value: function changeGroupOrder(columnId) {\n      var column = this.columns.find(function (c) {\n        return c.tableData.id === columnId;\n      });\n\n      if (column.tableData.groupSort === \"asc\") {\n        column.tableData.groupSort = \"desc\";\n      } else {\n        column.tableData.groupSort = \"asc\";\n      }\n\n      this.sorted = false;\n    }\n  }, {\n    key: \"changeColumnHidden\",\n    value: function changeColumnHidden(column, hidden) {\n      column.hidden = hidden;\n      column.hiddenByColumnsButton = hidden;\n    }\n  }, {\n    key: \"changeTreeExpand\",\n    value: function changeTreeExpand(path) {\n      var rowData = this.findDataByPath(this.sortedData, path);\n      rowData.tableData.isTreeExpanded = !rowData.tableData.isTreeExpanded;\n    }\n  }, {\n    key: \"changeDetailPanelType\",\n    value: function changeDetailPanelType(type) {\n      this.detailPanelType = type;\n    }\n  }, {\n    key: \"changeByDrag\",\n    value: function changeByDrag(result) {\n      var start = 0;\n      var groups = this.columns.filter(function (col) {\n        return col.tableData.groupOrder > -1;\n      }).sort(function (col1, col2) {\n        return col1.tableData.groupOrder - col2.tableData.groupOrder;\n      });\n\n      if (result.destination.droppableId === \"groups\" && result.source.droppableId === \"groups\") {\n        start = Math.min(result.destination.index, result.source.index);\n        var end = Math.max(result.destination.index, result.source.index);\n        groups = groups.slice(start, end + 1);\n\n        if (result.destination.index < result.source.index) {\n          // Take last and add as first\n          var last = groups.pop();\n          groups.unshift(last);\n        } else {\n          // Take first and add as last\n          var _last = groups.shift();\n\n          groups.push(_last);\n        }\n      } else if (result.destination.droppableId === \"groups\" && result.source.droppableId === \"headers\") {\n        var newGroup = this.columns.find(function (c) {\n          return c.tableData.id == result.draggableId;\n        });\n\n        if (newGroup.grouping === false || !newGroup.field) {\n          return;\n        }\n\n        groups.splice(result.destination.index, 0, newGroup);\n      } else if (result.destination.droppableId === \"headers\" && result.source.droppableId === \"groups\") {\n        var removeGroup = this.columns.find(function (c) {\n          return c.tableData.id == result.draggableId;\n        });\n        removeGroup.tableData.groupOrder = undefined;\n        groups.splice(result.source.index, 1);\n      } else if (result.destination.droppableId === \"headers\" && result.source.droppableId === \"headers\") {\n        start = Math.min(result.destination.index, result.source.index);\n\n        var _end = Math.max(result.destination.index, result.source.index); // get the effective start and end considering hidden columns\n\n\n        var sorted = this.columns.sort(function (a, b) {\n          return a.tableData.columnOrder - b.tableData.columnOrder;\n        }).filter(function (column) {\n          return column.tableData.groupOrder === undefined;\n        });\n        var numHiddenBeforeStart = 0;\n        var numVisibleBeforeStart = 0;\n\n        for (var i = 0; i < sorted.length && numVisibleBeforeStart <= start; i++) {\n          if (sorted[i].hidden) {\n            numHiddenBeforeStart++;\n          } else {\n            numVisibleBeforeStart++;\n          }\n        }\n\n        var effectiveStart = start + numHiddenBeforeStart;\n        var effectiveEnd = effectiveStart;\n\n        for (var numVisibleInRange = 0; numVisibleInRange < _end - start && effectiveEnd < sorted.length; effectiveEnd++) {\n          if (!sorted[effectiveEnd].hidden) {\n            numVisibleInRange++;\n          }\n        }\n\n        var colsToMov = sorted.slice(effectiveStart, effectiveEnd + 1);\n\n        if (result.destination.index < result.source.index) {\n          // Take last and add as first\n          var _last2 = colsToMov.pop();\n\n          colsToMov.unshift(_last2);\n        } else {\n          // Take first and add as last\n          var _last3 = colsToMov.shift();\n\n          colsToMov.push(_last3);\n        }\n\n        for (var _i = 0; _i < colsToMov.length; _i++) {\n          colsToMov[_i].tableData.columnOrder = effectiveStart + _i;\n        }\n\n        return;\n      } else {\n        return;\n      }\n\n      for (var _i2 = 0; _i2 < groups.length; _i2++) {\n        groups[_i2].tableData.groupOrder = start + _i2;\n      }\n\n      this.sorted = this.grouped = false;\n    }\n  }, {\n    key: \"findGroupByGroupPath\",\n    value: function findGroupByGroupPath(renderData, path) {\n      var data = {\n        groups: renderData,\n        groupsIndex: this.rootGroupsIndex\n      };\n      var node = path.reduce(function (result, current) {\n        if (!result) {\n          return undefined;\n        }\n\n        if (result.groupsIndex[current] !== undefined) {\n          return result.groups[result.groupsIndex[current]];\n        }\n\n        return undefined; // const group = result.groups.find(a => a.value === current);\n        // return group;\n      }, data);\n      return node;\n    }\n  }, {\n    key: \"isDataType\",\n    value: function isDataType(type) {\n      var dataType = \"normal\";\n\n      if (this.parentFunc) {\n        dataType = \"tree\";\n      } else if (this.columns.find(function (a) {\n        return a.tableData.groupOrder > -1;\n      })) {\n        dataType = \"group\";\n      }\n\n      return type === dataType;\n    }\n  }, {\n    key: \"sort\",\n    value: function sort(a, b, type) {\n      if (type === \"numeric\") {\n        return a - b;\n      } else {\n        if (a !== b) {\n          // to find nulls\n          if (!a) return -1;\n          if (!b) return 1;\n        }\n\n        return a < b ? -1 : a > b ? 1 : 0;\n      }\n    }\n  }, {\n    key: \"sortList\",\n    value: function sortList(list) {\n      var _this4 = this;\n\n      var columnDef = this.columns.find(function (_) {\n        return _.tableData.id === _this4.orderBy;\n      });\n      var result = list;\n\n      if (columnDef.customSort) {\n        if (this.orderDirection === \"desc\") {\n          result = list.sort(function (a, b) {\n            return columnDef.customSort(b, a, \"row\", \"desc\");\n          });\n        } else {\n          result = list.sort(function (a, b) {\n            return columnDef.customSort(a, b, \"row\");\n          });\n        }\n      } else {\n        result = list.sort(this.orderDirection === \"desc\" ? function (a, b) {\n          return _this4.sort(_this4.getFieldValue(b, columnDef), _this4.getFieldValue(a, columnDef), columnDef.type);\n        } : function (a, b) {\n          return _this4.sort(_this4.getFieldValue(a, columnDef), _this4.getFieldValue(b, columnDef), columnDef.type);\n        });\n      }\n\n      return result;\n    }\n  }, {\n    key: \"groupData\",\n    value: function groupData() {\n      var _this5 = this;\n\n      this.sorted = this.paged = false;\n      this.groupedDataLength = 0;\n      var tmpData = (0, _toConsumableArray2[\"default\"])(this.searchedData);\n      var groups = this.columns.filter(function (col) {\n        return col.tableData.groupOrder > -1;\n      }).sort(function (col1, col2) {\n        return col1.tableData.groupOrder - col2.tableData.groupOrder;\n      });\n      var subData = tmpData.reduce(function (result, currentRow) {\n        var object = result;\n        object = groups.reduce(function (o, colDef) {\n          var value = currentRow[colDef.field] || (0, _2.byString)(currentRow, colDef.field);\n          var group;\n\n          if (o.groupsIndex[value] !== undefined) {\n            group = o.groups[o.groupsIndex[value]];\n          }\n\n          if (!group) {\n            var path = [].concat((0, _toConsumableArray2[\"default\"])(o.path || []), [value]);\n            var oldGroup = _this5.findGroupByGroupPath(_this5.groupedData, path) || {\n              isExpanded: typeof _this5.defaultExpanded === \"boolean\" ? _this5.defaultExpanded : false\n            };\n            group = {\n              value: value,\n              groups: [],\n              groupsIndex: {},\n              data: [],\n              isExpanded: oldGroup.isExpanded,\n              path: path\n            };\n            o.groups.push(group);\n            o.groupsIndex[value] = o.groups.length - 1;\n          }\n\n          return group;\n        }, object);\n        object.data.push(currentRow);\n        _this5.groupedDataLength++;\n        return result;\n      }, {\n        groups: [],\n        groupsIndex: {}\n      });\n      this.groupedData = subData.groups;\n      this.grouped = true;\n      this.rootGroupsIndex = subData.groupsIndex;\n    }\n  }, {\n    key: \"treefyData\",\n    value: function treefyData() {\n      var _this6 = this;\n\n      this.sorted = this.paged = false;\n      this.data.forEach(function (a) {\n        return a.tableData.childRows = null;\n      });\n      this.treefiedData = [];\n      this.treefiedDataLength = 0;\n      this.treeDataMaxLevel = 0; // if filter or search is enabled, collapse the tree\n\n      if (this.searchText || this.columns.some(function (columnDef) {\n        return columnDef.tableData.filterValue;\n      })) {\n        this.data.forEach(function (row) {\n          row.tableData.isTreeExpanded = false;\n        }); // expand the tree for all nodes present after filtering and searching\n\n        this.expandTreeForNodes(this.searchedData);\n      }\n\n      var addRow = function addRow(rowData) {\n        rowData.tableData.markedForTreeRemove = false;\n\n        var parent = _this6.parentFunc(rowData, _this6.data);\n\n        if (parent) {\n          parent.tableData.childRows = parent.tableData.childRows || [];\n\n          if (!parent.tableData.childRows.includes(rowData)) {\n            parent.tableData.childRows.push(rowData);\n            _this6.treefiedDataLength++;\n          }\n\n          addRow(parent);\n          rowData.tableData.path = [].concat((0, _toConsumableArray2[\"default\"])(parent.tableData.path), [parent.tableData.childRows.length - 1]);\n          _this6.treeDataMaxLevel = Math.max(_this6.treeDataMaxLevel, rowData.tableData.path.length);\n        } else {\n          if (!_this6.treefiedData.includes(rowData)) {\n            _this6.treefiedData.push(rowData);\n\n            _this6.treefiedDataLength++;\n            rowData.tableData.path = [_this6.treefiedData.length - 1];\n          }\n        }\n      }; // Add all rows initially\n\n\n      this.data.forEach(function (rowData) {\n        addRow(rowData);\n      });\n\n      var markForTreeRemove = function markForTreeRemove(rowData) {\n        var pointer = _this6.treefiedData;\n        rowData.tableData.path.forEach(function (pathPart) {\n          if (pointer.tableData && pointer.tableData.childRows) {\n            pointer = pointer.tableData.childRows;\n          }\n\n          pointer = pointer[pathPart];\n        });\n        pointer.tableData.markedForTreeRemove = true;\n      };\n\n      var traverseChildrenAndUnmark = function traverseChildrenAndUnmark(rowData) {\n        if (rowData.tableData.childRows) {\n          rowData.tableData.childRows.forEach(function (row) {\n            traverseChildrenAndUnmark(row);\n          });\n        }\n\n        rowData.tableData.markedForTreeRemove = false;\n      }; // for all data rows, restore initial expand if no search term is available and remove items that shouldn't be there\n\n\n      this.data.forEach(function (rowData) {\n        if (!_this6.searchText && !_this6.columns.some(function (columnDef) {\n          return columnDef.tableData.filterValue;\n        })) {\n          if (rowData.tableData.isTreeExpanded === undefined) {\n            var isExpanded = typeof _this6.defaultExpanded === \"boolean\" ? _this6.defaultExpanded : _this6.defaultExpanded(rowData);\n            rowData.tableData.isTreeExpanded = isExpanded;\n          }\n        }\n\n        var hasSearchMatchedChildren = rowData.tableData.isTreeExpanded;\n\n        if (!hasSearchMatchedChildren && _this6.searchedData.indexOf(rowData) < 0) {\n          markForTreeRemove(rowData);\n        }\n      }); // preserve all children of nodes that are matched by search or filters\n\n      this.data.forEach(function (rowData) {\n        if (_this6.searchedData.indexOf(rowData) > -1) {\n          traverseChildrenAndUnmark(rowData);\n        }\n      });\n\n      var traverseTreeAndDeleteMarked = function traverseTreeAndDeleteMarked(rowDataArray) {\n        for (var i = rowDataArray.length - 1; i >= 0; i--) {\n          var item = rowDataArray[i];\n\n          if (item.tableData.childRows) {\n            traverseTreeAndDeleteMarked(item.tableData.childRows);\n          }\n\n          if (item.tableData.markedForTreeRemove) rowDataArray.splice(i, 1);\n        }\n      };\n\n      traverseTreeAndDeleteMarked(this.treefiedData);\n      this.treefied = true;\n    }\n  }, {\n    key: \"sortData\",\n    value: function sortData() {\n      var _this7 = this;\n\n      this.paged = false;\n\n      if (this.isDataType(\"group\")) {\n        this.sortedData = (0, _toConsumableArray2[\"default\"])(this.groupedData);\n        var groups = this.columns.filter(function (col) {\n          return col.tableData.groupOrder > -1;\n        }).sort(function (col1, col2) {\n          return col1.tableData.groupOrder - col2.tableData.groupOrder;\n        });\n\n        var sortGroups = function sortGroups(list, columnDef) {\n          if (columnDef.customSort) {\n            return list.sort(columnDef.tableData.groupSort === \"desc\" ? function (a, b) {\n              return columnDef.customSort(b.value, a.value, \"group\");\n            } : function (a, b) {\n              return columnDef.customSort(a.value, b.value, \"group\");\n            });\n          } else {\n            return list.sort(columnDef.tableData.groupSort === \"desc\" ? function (a, b) {\n              return _this7.sort(b.value, a.value, columnDef.type);\n            } : function (a, b) {\n              return _this7.sort(a.value, b.value, columnDef.type);\n            });\n          }\n        };\n\n        this.sortedData = sortGroups(this.sortedData, groups[0]);\n\n        var sortGroupData = function sortGroupData(list, level) {\n          list.forEach(function (element) {\n            if (element.groups.length > 0) {\n              var column = groups[level];\n              element.groups = sortGroups(element.groups, column);\n              sortGroupData(element.groups, level + 1);\n            } else {\n              if (_this7.orderBy >= 0 && _this7.orderDirection) {\n                element.data = _this7.sortList(element.data);\n              }\n            }\n          });\n        };\n\n        sortGroupData(this.sortedData, 1);\n      } else if (this.isDataType(\"tree\")) {\n        this.sortedData = (0, _toConsumableArray2[\"default\"])(this.treefiedData);\n\n        if (this.orderBy != -1) {\n          this.sortedData = this.sortList(this.sortedData);\n\n          var sortTree = function sortTree(list) {\n            list.forEach(function (item) {\n              if (item.tableData.childRows) {\n                item.tableData.childRows = _this7.sortList(item.tableData.childRows);\n                sortTree(item.tableData.childRows);\n              }\n            });\n          };\n\n          sortTree(this.sortedData);\n        }\n      } else if (this.isDataType(\"normal\")) {\n        this.sortedData = (0, _toConsumableArray2[\"default\"])(this.searchedData);\n\n        if (this.orderBy != -1 && this.applySort) {\n          this.sortedData = this.sortList(this.sortedData);\n        }\n      }\n\n      this.sorted = true;\n    }\n  }, {\n    key: \"pageData\",\n    value: function pageData() {\n      this.pagedData = (0, _toConsumableArray2[\"default\"])(this.sortedData);\n\n      if (this.paging) {\n        var startIndex = this.currentPage * this.pageSize;\n        var endIndex = startIndex + this.pageSize;\n        this.pagedData = this.pagedData.slice(startIndex, endIndex);\n      }\n\n      this.paged = true;\n    }\n  }]);\n  return DataManager;\n}();\n\nexports[\"default\"] = DataManager;","map":{"version":3,"sources":["C:/Users/AB/Desktop/work/sallis/node_modules/material-table/dist/utils/data-manager.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","_objectSpread2","_toConsumableArray2","_classCallCheck2","_createClass2","_defineProperty2","_format","_2","DataManager","_this","undefined","rowData","columnDef","tableData","editCellList","concat","index","findIndex","c","id","splice","bulkEditChangedRows","oldData","newData","data","forEach","row","currentRow","parentFunc","parent","isTreeExpanded","renderData","path","isDataType","node","reduce","result","current","childRows","groups","_node","length","lookup","arguments","field","byString","filtered","filterData","searched","searchData","grouped","groupData","treefied","treefyData","sorted","sortData","paged","pageData","columns","currentPage","sortedData","lastEditingRow","orderBy","orderDirection","originalData","pageSize","pagedData","searchText","selectedCount","treefiedDataLength","treeDataMaxLevel","groupedDataLength","filteredData","applyFilters","filter","filterValue","type","customFilterAndSearch","getFieldValue","indexOf","toString","includes","currentDate","Date","selectedDate","currentDateToCompare","selectedDateToCompare","currentHour","selectedHour","currentHourToCompare","toUpperCase","searchedData","applySearch","searchable","hidden","some","key","setData","_this2","map","checked","setColumns","undefinedWidthColumns","width","usedWidth","columnOrder","defaultFilter","groupOrder","defaultGroupOrder","groupSort","defaultGroupSort","push","join","setDefaultExpanded","expanded","defaultExpanded","changeApplySearch","changeApplyFilters","changeApplySort","applySort","changePaging","paging","changeCurrentPage","changePageSize","changeParentFunc","changeFilterValue","columnId","changeRowSelected","_this3","findDataByPath","checkChildRows","childRow","changeDetailPanelVisibility","render","showDetailPanel","detailPanelType","lastDetailPanelRow","changeGroupExpand","isExpanded","changeSearchText","changeRowEditing","mode","editing","changeBulkEditOpen","bulkEditOpen","changeAllSelected","setCheck","element","d","disabled","groupedData","changeOrder","changeGroupOrder","column","find","changeColumnHidden","hiddenByColumnsButton","changeTreeExpand","changeDetailPanelType","changeByDrag","start","col","sort","col1","col2","destination","droppableId","source","Math","min","end","max","slice","last","pop","unshift","_last","shift","newGroup","draggableId","grouping","removeGroup","_end","a","b","numHiddenBeforeStart","numVisibleBeforeStart","i","effectiveStart","effectiveEnd","numVisibleInRange","colsToMov","_last2","_last3","_i","_i2","findGroupByGroupPath","groupsIndex","rootGroupsIndex","dataType","sortList","list","_this4","_","customSort","_this5","tmpData","subData","object","o","colDef","group","oldGroup","_this6","treefiedData","expandTreeForNodes","addRow","markedForTreeRemove","markForTreeRemove","pointer","pathPart","traverseChildrenAndUnmark","hasSearchMatchedChildren","traverseTreeAndDeleteMarked","rowDataArray","item","_this7","sortGroups","sortGroupData","level","sortTree","startIndex","endIndex"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\n\nvar _objectSpread2 = _interopRequireDefault(require(\"@babel/runtime/helpers/objectSpread\"));\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _defineProperty2 = _interopRequireDefault(require(\"@babel/runtime/helpers/defineProperty\"));\n\nvar _format = _interopRequireDefault(require(\"date-fns/format\"));\n\nvar _2 = require(\"./\");\n\nvar DataManager = /*#__PURE__*/function () {\n  function DataManager() {\n    var _this = this;\n\n    (0, _classCallCheck2[\"default\"])(this, DataManager);\n    (0, _defineProperty2[\"default\"])(this, \"applyFilters\", false);\n    (0, _defineProperty2[\"default\"])(this, \"applySearch\", false);\n    (0, _defineProperty2[\"default\"])(this, \"applySort\", false);\n    (0, _defineProperty2[\"default\"])(this, \"currentPage\", 0);\n    (0, _defineProperty2[\"default\"])(this, \"detailPanelType\", \"multiple\");\n    (0, _defineProperty2[\"default\"])(this, \"lastDetailPanelRow\", undefined);\n    (0, _defineProperty2[\"default\"])(this, \"lastEditingRow\", undefined);\n    (0, _defineProperty2[\"default\"])(this, \"orderBy\", -1);\n    (0, _defineProperty2[\"default\"])(this, \"orderDirection\", \"\");\n    (0, _defineProperty2[\"default\"])(this, \"pageSize\", 5);\n    (0, _defineProperty2[\"default\"])(this, \"paging\", true);\n    (0, _defineProperty2[\"default\"])(this, \"parentFunc\", null);\n    (0, _defineProperty2[\"default\"])(this, \"searchText\", \"\");\n    (0, _defineProperty2[\"default\"])(this, \"selectedCount\", 0);\n    (0, _defineProperty2[\"default\"])(this, \"treefiedDataLength\", 0);\n    (0, _defineProperty2[\"default\"])(this, \"treeDataMaxLevel\", 0);\n    (0, _defineProperty2[\"default\"])(this, \"groupedDataLength\", 0);\n    (0, _defineProperty2[\"default\"])(this, \"defaultExpanded\", false);\n    (0, _defineProperty2[\"default\"])(this, \"bulkEditOpen\", false);\n    (0, _defineProperty2[\"default\"])(this, \"bulkEditChangedRows\", {});\n    (0, _defineProperty2[\"default\"])(this, \"data\", []);\n    (0, _defineProperty2[\"default\"])(this, \"columns\", []);\n    (0, _defineProperty2[\"default\"])(this, \"filteredData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"searchedData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"groupedData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"treefiedData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"sortedData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"pagedData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"renderData\", []);\n    (0, _defineProperty2[\"default\"])(this, \"filtered\", false);\n    (0, _defineProperty2[\"default\"])(this, \"searched\", false);\n    (0, _defineProperty2[\"default\"])(this, \"grouped\", false);\n    (0, _defineProperty2[\"default\"])(this, \"treefied\", false);\n    (0, _defineProperty2[\"default\"])(this, \"sorted\", false);\n    (0, _defineProperty2[\"default\"])(this, \"paged\", false);\n    (0, _defineProperty2[\"default\"])(this, \"rootGroupsIndex\", {});\n    (0, _defineProperty2[\"default\"])(this, \"startCellEditable\", function (rowData, columnDef) {\n      rowData.tableData.editCellList = [].concat((0, _toConsumableArray2[\"default\"])(rowData.tableData.editCellList || []), [columnDef]);\n    });\n    (0, _defineProperty2[\"default\"])(this, \"finishCellEditable\", function (rowData, columnDef) {\n      if (rowData.tableData.editCellList) {\n        var index = rowData.tableData.editCellList.findIndex(function (c) {\n          return c.tableData.id === columnDef.tableData.id;\n        });\n\n        if (index !== -1) {\n          rowData.tableData.editCellList.splice(index, 1);\n        }\n      }\n    });\n    (0, _defineProperty2[\"default\"])(this, \"clearBulkEditChangedRows\", function () {\n      _this.bulkEditChangedRows = {};\n    });\n    (0, _defineProperty2[\"default\"])(this, \"onBulkEditRowChanged\", function (oldData, newData) {\n      _this.bulkEditChangedRows[oldData.tableData.id] = {\n        oldData: oldData,\n        newData: newData\n      };\n    });\n    (0, _defineProperty2[\"default\"])(this, \"expandTreeForNodes\", function (data) {\n      data.forEach(function (row) {\n        var currentRow = row;\n\n        while (_this.parentFunc(currentRow, _this.data)) {\n          var parent = _this.parentFunc(currentRow, _this.data);\n\n          if (parent) {\n            parent.tableData.isTreeExpanded = true;\n          }\n\n          currentRow = parent;\n        }\n      });\n    });\n    (0, _defineProperty2[\"default\"])(this, \"findDataByPath\", function (renderData, path) {\n      if (_this.isDataType(\"tree\")) {\n        var node = path.reduce(function (result, current) {\n          return result && result.tableData && result.tableData.childRows && result.tableData.childRows[current];\n        }, {\n          tableData: {\n            childRows: renderData\n          }\n        });\n        return node;\n      } else {\n        var data = {\n          groups: renderData\n        };\n\n        var _node = path.reduce(function (result, current) {\n          if (result.groups.length > 0) {\n            return result.groups[current];\n          } else if (result.data) {\n            return result.data[current];\n          } else {\n            return undefined;\n          }\n        }, data);\n\n        return _node;\n      }\n    });\n    (0, _defineProperty2[\"default\"])(this, \"getFieldValue\", function (rowData, columnDef) {\n      var lookup = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n      var value = typeof rowData[columnDef.field] !== \"undefined\" ? rowData[columnDef.field] : (0, _2.byString)(rowData, columnDef.field);\n\n      if (columnDef.lookup && lookup) {\n        value = columnDef.lookup[value];\n      }\n\n      return value;\n    });\n    (0, _defineProperty2[\"default\"])(this, \"getRenderState\", function () {\n      if (_this.filtered === false) {\n        _this.filterData();\n      }\n\n      if (_this.searched === false) {\n        _this.searchData();\n      }\n\n      if (_this.grouped === false && _this.isDataType(\"group\")) {\n        _this.groupData();\n      }\n\n      if (_this.treefied === false && _this.isDataType(\"tree\")) {\n        _this.treefyData();\n      }\n\n      if (_this.sorted === false) {\n        _this.sortData();\n      }\n\n      if (_this.paged === false) {\n        _this.pageData();\n      }\n\n      return {\n        columns: _this.columns,\n        currentPage: _this.currentPage,\n        data: _this.sortedData,\n        lastEditingRow: _this.lastEditingRow,\n        orderBy: _this.orderBy,\n        orderDirection: _this.orderDirection,\n        originalData: _this.data,\n        pageSize: _this.pageSize,\n        renderData: _this.pagedData,\n        searchText: _this.searchText,\n        selectedCount: _this.selectedCount,\n        treefiedDataLength: _this.treefiedDataLength,\n        treeDataMaxLevel: _this.treeDataMaxLevel,\n        groupedDataLength: _this.groupedDataLength\n      };\n    });\n    (0, _defineProperty2[\"default\"])(this, \"filterData\", function () {\n      _this.searched = _this.grouped = _this.treefied = _this.sorted = _this.paged = false;\n      _this.filteredData = (0, _toConsumableArray2[\"default\"])(_this.data);\n\n      if (_this.applyFilters) {\n        _this.columns.filter(function (columnDef) {\n          return columnDef.tableData.filterValue;\n        }).forEach(function (columnDef) {\n          var lookup = columnDef.lookup,\n              type = columnDef.type,\n              tableData = columnDef.tableData;\n\n          if (columnDef.customFilterAndSearch) {\n            _this.filteredData = _this.filteredData.filter(function (row) {\n              return !!columnDef.customFilterAndSearch(tableData.filterValue, row, columnDef);\n            });\n          } else {\n            if (lookup) {\n              _this.filteredData = _this.filteredData.filter(function (row) {\n                var value = _this.getFieldValue(row, columnDef, false);\n\n                return !tableData.filterValue || tableData.filterValue.length === 0 || tableData.filterValue.indexOf(value !== undefined && value !== null && value.toString()) > -1;\n              });\n            } else if (type === \"numeric\") {\n              _this.filteredData = _this.filteredData.filter(function (row) {\n                var value = _this.getFieldValue(row, columnDef);\n\n                return value + \"\" === tableData.filterValue;\n              });\n            } else if (type === \"boolean\" && tableData.filterValue) {\n              _this.filteredData = _this.filteredData.filter(function (row) {\n                var value = _this.getFieldValue(row, columnDef);\n\n                return value && tableData.filterValue === \"checked\" || !value && tableData.filterValue === \"unchecked\";\n              });\n            } else if ([\"date\", \"datetime\"].includes(type)) {\n              _this.filteredData = _this.filteredData.filter(function (row) {\n                var value = _this.getFieldValue(row, columnDef);\n\n                var currentDate = value ? new Date(value) : null;\n\n                if (currentDate && currentDate.toString() !== \"Invalid Date\") {\n                  var selectedDate = tableData.filterValue;\n                  var currentDateToCompare = \"\";\n                  var selectedDateToCompare = \"\";\n\n                  if (type === \"date\") {\n                    currentDateToCompare = (0, _format[\"default\"])(currentDate, \"MM/dd/yyyy\");\n                    selectedDateToCompare = (0, _format[\"default\"])(selectedDate, \"MM/dd/yyyy\");\n                  } else if (type === \"datetime\") {\n                    currentDateToCompare = (0, _format[\"default\"])(currentDate, \"MM/dd/yyyy - HH:mm\");\n                    selectedDateToCompare = (0, _format[\"default\"])(selectedDate, \"MM/dd/yyyy - HH:mm\");\n                  }\n\n                  return currentDateToCompare === selectedDateToCompare;\n                }\n\n                return true;\n              });\n            } else if (type === \"time\") {\n              _this.filteredData = _this.filteredData.filter(function (row) {\n                var value = _this.getFieldValue(row, columnDef);\n\n                var currentHour = value || null;\n\n                if (currentHour) {\n                  var selectedHour = tableData.filterValue;\n                  var currentHourToCompare = (0, _format[\"default\"])(selectedHour, \"HH:mm\");\n                  return currentHour === currentHourToCompare;\n                }\n\n                return true;\n              });\n            } else {\n              _this.filteredData = _this.filteredData.filter(function (row) {\n                var value = _this.getFieldValue(row, columnDef);\n\n                return value && value.toString().toUpperCase().includes(tableData.filterValue.toUpperCase());\n              });\n            }\n          }\n        });\n      }\n\n      _this.filtered = true;\n    });\n    (0, _defineProperty2[\"default\"])(this, \"searchData\", function () {\n      _this.grouped = _this.treefied = _this.sorted = _this.paged = false;\n      _this.searchedData = (0, _toConsumableArray2[\"default\"])(_this.filteredData);\n\n      if (_this.searchText && _this.applySearch) {\n        _this.searchedData = _this.searchedData.filter(function (row) {\n          return _this.columns.filter(function (columnDef) {\n            return columnDef.searchable === undefined ? !columnDef.hidden : columnDef.searchable;\n          }).some(function (columnDef) {\n            if (columnDef.customFilterAndSearch) {\n              return !!columnDef.customFilterAndSearch(_this.searchText, row, columnDef);\n            } else if (columnDef.field) {\n              var value = _this.getFieldValue(row, columnDef);\n\n              if (value) {\n                return value.toString().toUpperCase().includes(_this.searchText.toUpperCase());\n              }\n            }\n          });\n        });\n      }\n\n      _this.searched = true;\n    });\n  }\n\n  (0, _createClass2[\"default\"])(DataManager, [{\n    key: \"setData\",\n    value: function setData(data) {\n      var _this2 = this;\n\n      this.selectedCount = 0;\n      this.data = data.map(function (row, index) {\n        row.tableData = (0, _objectSpread2[\"default\"])({}, row.tableData, {\n          id: index\n        });\n\n        if (row.tableData.checked) {\n          _this2.selectedCount++;\n        }\n\n        return row;\n      });\n      this.filtered = false;\n    }\n  }, {\n    key: \"setColumns\",\n    value: function setColumns(columns) {\n      var undefinedWidthColumns = columns.filter(function (c) {\n        return c.width === undefined && !c.hidden;\n      });\n      var usedWidth = [\"0px\"];\n      this.columns = columns.map(function (columnDef, index) {\n        columnDef.tableData = (0, _objectSpread2[\"default\"])({\n          columnOrder: index,\n          filterValue: columnDef.defaultFilter,\n          groupOrder: columnDef.defaultGroupOrder,\n          groupSort: columnDef.defaultGroupSort || \"asc\",\n          width: columnDef.width\n        }, columnDef.tableData, {\n          id: index\n        });\n\n        if (columnDef.width !== undefined) {\n          if (typeof columnDef.width === \"number\") {\n            usedWidth.push(columnDef.width + \"px\");\n          } else {\n            usedWidth.push(columnDef.width);\n          }\n        }\n\n        return columnDef;\n      });\n      usedWidth = \"(\" + usedWidth.join(\" + \") + \")\";\n      undefinedWidthColumns.forEach(function (columnDef) {\n        columnDef.tableData.width = \"calc((100% - \".concat(usedWidth, \") / \").concat(undefinedWidthColumns.length, \")\");\n      });\n    }\n  }, {\n    key: \"setDefaultExpanded\",\n    value: function setDefaultExpanded(expanded) {\n      this.defaultExpanded = expanded;\n    }\n  }, {\n    key: \"changeApplySearch\",\n    value: function changeApplySearch(applySearch) {\n      this.applySearch = applySearch;\n      this.searched = false;\n    }\n  }, {\n    key: \"changeApplyFilters\",\n    value: function changeApplyFilters(applyFilters) {\n      this.applyFilters = applyFilters;\n      this.filtered = false;\n    }\n  }, {\n    key: \"changeApplySort\",\n    value: function changeApplySort(applySort) {\n      this.applySort = applySort;\n      this.sorted = false;\n    }\n  }, {\n    key: \"changePaging\",\n    value: function changePaging(paging) {\n      this.paging = paging;\n      this.paged = false;\n    }\n  }, {\n    key: \"changeCurrentPage\",\n    value: function changeCurrentPage(currentPage) {\n      this.currentPage = currentPage;\n      this.paged = false;\n    }\n  }, {\n    key: \"changePageSize\",\n    value: function changePageSize(pageSize) {\n      this.pageSize = pageSize;\n      this.paged = false;\n    }\n  }, {\n    key: \"changeParentFunc\",\n    value: function changeParentFunc(parentFunc) {\n      this.parentFunc = parentFunc;\n    }\n  }, {\n    key: \"changeFilterValue\",\n    value: function changeFilterValue(columnId, value) {\n      this.columns[columnId].tableData.filterValue = value;\n      this.filtered = false;\n    }\n  }, {\n    key: \"changeRowSelected\",\n    value: function changeRowSelected(checked, path) {\n      var _this3 = this;\n\n      var rowData = this.findDataByPath(this.sortedData, path);\n      rowData.tableData.checked = checked;\n      this.selectedCount = this.selectedCount + (checked ? 1 : -1);\n\n      var checkChildRows = function checkChildRows(rowData) {\n        if (rowData.tableData.childRows) {\n          rowData.tableData.childRows.forEach(function (childRow) {\n            if (childRow.tableData.checked !== checked) {\n              childRow.tableData.checked = checked;\n              _this3.selectedCount = _this3.selectedCount + (checked ? 1 : -1);\n            }\n\n            checkChildRows(childRow);\n          });\n        }\n      };\n\n      checkChildRows(rowData);\n      this.filtered = false;\n    }\n  }, {\n    key: \"changeDetailPanelVisibility\",\n    value: function changeDetailPanelVisibility(path, render) {\n      var rowData = this.findDataByPath(this.sortedData, path);\n\n      if ((rowData.tableData.showDetailPanel || \"\").toString() === render.toString()) {\n        rowData.tableData.showDetailPanel = undefined;\n      } else {\n        rowData.tableData.showDetailPanel = render;\n      }\n\n      if (this.detailPanelType === \"single\" && this.lastDetailPanelRow && this.lastDetailPanelRow != rowData) {\n        this.lastDetailPanelRow.tableData.showDetailPanel = undefined;\n      }\n\n      this.lastDetailPanelRow = rowData;\n    }\n  }, {\n    key: \"changeGroupExpand\",\n    value: function changeGroupExpand(path) {\n      var rowData = this.findDataByPath(this.sortedData, path);\n      rowData.isExpanded = !rowData.isExpanded;\n    }\n  }, {\n    key: \"changeSearchText\",\n    value: function changeSearchText(searchText) {\n      this.searchText = searchText;\n      this.searched = false;\n      this.currentPage = 0;\n    }\n  }, {\n    key: \"changeRowEditing\",\n    value: function changeRowEditing(rowData, mode) {\n      if (rowData) {\n        rowData.tableData.editing = mode;\n\n        if (this.lastEditingRow && this.lastEditingRow != rowData) {\n          this.lastEditingRow.tableData.editing = undefined;\n        }\n\n        if (mode) {\n          this.lastEditingRow = rowData;\n        } else {\n          this.lastEditingRow = undefined;\n        }\n      } else if (this.lastEditingRow) {\n        this.lastEditingRow.tableData.editing = undefined;\n        this.lastEditingRow = undefined;\n      }\n    }\n  }, {\n    key: \"changeBulkEditOpen\",\n    value: function changeBulkEditOpen(bulkEditOpen) {\n      this.bulkEditOpen = bulkEditOpen;\n    }\n  }, {\n    key: \"changeAllSelected\",\n    value: function changeAllSelected(checked) {\n      var selectedCount = 0;\n\n      if (this.isDataType(\"group\")) {\n        var setCheck = function setCheck(data) {\n          data.forEach(function (element) {\n            if (element.groups.length > 0) {\n              setCheck(element.groups);\n            } else {\n              element.data.forEach(function (d) {\n                d.tableData.checked = d.tableData.disabled ? false : checked;\n                selectedCount++;\n              });\n            }\n          });\n        };\n\n        setCheck(this.groupedData);\n      } else {\n        this.searchedData.map(function (row) {\n          row.tableData.checked = row.tableData.disabled ? false : checked;\n          return row;\n        });\n        selectedCount = this.searchedData.length;\n      }\n\n      this.selectedCount = checked ? selectedCount : 0;\n    }\n  }, {\n    key: \"changeOrder\",\n    value: function changeOrder(orderBy, orderDirection) {\n      this.orderBy = orderBy;\n      this.orderDirection = orderDirection;\n      this.currentPage = 0;\n      this.sorted = false;\n    }\n  }, {\n    key: \"changeGroupOrder\",\n    value: function changeGroupOrder(columnId) {\n      var column = this.columns.find(function (c) {\n        return c.tableData.id === columnId;\n      });\n\n      if (column.tableData.groupSort === \"asc\") {\n        column.tableData.groupSort = \"desc\";\n      } else {\n        column.tableData.groupSort = \"asc\";\n      }\n\n      this.sorted = false;\n    }\n  }, {\n    key: \"changeColumnHidden\",\n    value: function changeColumnHidden(column, hidden) {\n      column.hidden = hidden;\n      column.hiddenByColumnsButton = hidden;\n    }\n  }, {\n    key: \"changeTreeExpand\",\n    value: function changeTreeExpand(path) {\n      var rowData = this.findDataByPath(this.sortedData, path);\n      rowData.tableData.isTreeExpanded = !rowData.tableData.isTreeExpanded;\n    }\n  }, {\n    key: \"changeDetailPanelType\",\n    value: function changeDetailPanelType(type) {\n      this.detailPanelType = type;\n    }\n  }, {\n    key: \"changeByDrag\",\n    value: function changeByDrag(result) {\n      var start = 0;\n      var groups = this.columns.filter(function (col) {\n        return col.tableData.groupOrder > -1;\n      }).sort(function (col1, col2) {\n        return col1.tableData.groupOrder - col2.tableData.groupOrder;\n      });\n\n      if (result.destination.droppableId === \"groups\" && result.source.droppableId === \"groups\") {\n        start = Math.min(result.destination.index, result.source.index);\n        var end = Math.max(result.destination.index, result.source.index);\n        groups = groups.slice(start, end + 1);\n\n        if (result.destination.index < result.source.index) {\n          // Take last and add as first\n          var last = groups.pop();\n          groups.unshift(last);\n        } else {\n          // Take first and add as last\n          var _last = groups.shift();\n\n          groups.push(_last);\n        }\n      } else if (result.destination.droppableId === \"groups\" && result.source.droppableId === \"headers\") {\n        var newGroup = this.columns.find(function (c) {\n          return c.tableData.id == result.draggableId;\n        });\n\n        if (newGroup.grouping === false || !newGroup.field) {\n          return;\n        }\n\n        groups.splice(result.destination.index, 0, newGroup);\n      } else if (result.destination.droppableId === \"headers\" && result.source.droppableId === \"groups\") {\n        var removeGroup = this.columns.find(function (c) {\n          return c.tableData.id == result.draggableId;\n        });\n        removeGroup.tableData.groupOrder = undefined;\n        groups.splice(result.source.index, 1);\n      } else if (result.destination.droppableId === \"headers\" && result.source.droppableId === \"headers\") {\n        start = Math.min(result.destination.index, result.source.index);\n\n        var _end = Math.max(result.destination.index, result.source.index); // get the effective start and end considering hidden columns\n\n\n        var sorted = this.columns.sort(function (a, b) {\n          return a.tableData.columnOrder - b.tableData.columnOrder;\n        }).filter(function (column) {\n          return column.tableData.groupOrder === undefined;\n        });\n        var numHiddenBeforeStart = 0;\n        var numVisibleBeforeStart = 0;\n\n        for (var i = 0; i < sorted.length && numVisibleBeforeStart <= start; i++) {\n          if (sorted[i].hidden) {\n            numHiddenBeforeStart++;\n          } else {\n            numVisibleBeforeStart++;\n          }\n        }\n\n        var effectiveStart = start + numHiddenBeforeStart;\n        var effectiveEnd = effectiveStart;\n\n        for (var numVisibleInRange = 0; numVisibleInRange < _end - start && effectiveEnd < sorted.length; effectiveEnd++) {\n          if (!sorted[effectiveEnd].hidden) {\n            numVisibleInRange++;\n          }\n        }\n\n        var colsToMov = sorted.slice(effectiveStart, effectiveEnd + 1);\n\n        if (result.destination.index < result.source.index) {\n          // Take last and add as first\n          var _last2 = colsToMov.pop();\n\n          colsToMov.unshift(_last2);\n        } else {\n          // Take first and add as last\n          var _last3 = colsToMov.shift();\n\n          colsToMov.push(_last3);\n        }\n\n        for (var _i = 0; _i < colsToMov.length; _i++) {\n          colsToMov[_i].tableData.columnOrder = effectiveStart + _i;\n        }\n\n        return;\n      } else {\n        return;\n      }\n\n      for (var _i2 = 0; _i2 < groups.length; _i2++) {\n        groups[_i2].tableData.groupOrder = start + _i2;\n      }\n\n      this.sorted = this.grouped = false;\n    }\n  }, {\n    key: \"findGroupByGroupPath\",\n    value: function findGroupByGroupPath(renderData, path) {\n      var data = {\n        groups: renderData,\n        groupsIndex: this.rootGroupsIndex\n      };\n      var node = path.reduce(function (result, current) {\n        if (!result) {\n          return undefined;\n        }\n\n        if (result.groupsIndex[current] !== undefined) {\n          return result.groups[result.groupsIndex[current]];\n        }\n\n        return undefined; // const group = result.groups.find(a => a.value === current);\n        // return group;\n      }, data);\n      return node;\n    }\n  }, {\n    key: \"isDataType\",\n    value: function isDataType(type) {\n      var dataType = \"normal\";\n\n      if (this.parentFunc) {\n        dataType = \"tree\";\n      } else if (this.columns.find(function (a) {\n        return a.tableData.groupOrder > -1;\n      })) {\n        dataType = \"group\";\n      }\n\n      return type === dataType;\n    }\n  }, {\n    key: \"sort\",\n    value: function sort(a, b, type) {\n      if (type === \"numeric\") {\n        return a - b;\n      } else {\n        if (a !== b) {\n          // to find nulls\n          if (!a) return -1;\n          if (!b) return 1;\n        }\n\n        return a < b ? -1 : a > b ? 1 : 0;\n      }\n    }\n  }, {\n    key: \"sortList\",\n    value: function sortList(list) {\n      var _this4 = this;\n\n      var columnDef = this.columns.find(function (_) {\n        return _.tableData.id === _this4.orderBy;\n      });\n      var result = list;\n\n      if (columnDef.customSort) {\n        if (this.orderDirection === \"desc\") {\n          result = list.sort(function (a, b) {\n            return columnDef.customSort(b, a, \"row\", \"desc\");\n          });\n        } else {\n          result = list.sort(function (a, b) {\n            return columnDef.customSort(a, b, \"row\");\n          });\n        }\n      } else {\n        result = list.sort(this.orderDirection === \"desc\" ? function (a, b) {\n          return _this4.sort(_this4.getFieldValue(b, columnDef), _this4.getFieldValue(a, columnDef), columnDef.type);\n        } : function (a, b) {\n          return _this4.sort(_this4.getFieldValue(a, columnDef), _this4.getFieldValue(b, columnDef), columnDef.type);\n        });\n      }\n\n      return result;\n    }\n  }, {\n    key: \"groupData\",\n    value: function groupData() {\n      var _this5 = this;\n\n      this.sorted = this.paged = false;\n      this.groupedDataLength = 0;\n      var tmpData = (0, _toConsumableArray2[\"default\"])(this.searchedData);\n      var groups = this.columns.filter(function (col) {\n        return col.tableData.groupOrder > -1;\n      }).sort(function (col1, col2) {\n        return col1.tableData.groupOrder - col2.tableData.groupOrder;\n      });\n      var subData = tmpData.reduce(function (result, currentRow) {\n        var object = result;\n        object = groups.reduce(function (o, colDef) {\n          var value = currentRow[colDef.field] || (0, _2.byString)(currentRow, colDef.field);\n          var group;\n\n          if (o.groupsIndex[value] !== undefined) {\n            group = o.groups[o.groupsIndex[value]];\n          }\n\n          if (!group) {\n            var path = [].concat((0, _toConsumableArray2[\"default\"])(o.path || []), [value]);\n            var oldGroup = _this5.findGroupByGroupPath(_this5.groupedData, path) || {\n              isExpanded: typeof _this5.defaultExpanded === \"boolean\" ? _this5.defaultExpanded : false\n            };\n            group = {\n              value: value,\n              groups: [],\n              groupsIndex: {},\n              data: [],\n              isExpanded: oldGroup.isExpanded,\n              path: path\n            };\n            o.groups.push(group);\n            o.groupsIndex[value] = o.groups.length - 1;\n          }\n\n          return group;\n        }, object);\n        object.data.push(currentRow);\n        _this5.groupedDataLength++;\n        return result;\n      }, {\n        groups: [],\n        groupsIndex: {}\n      });\n      this.groupedData = subData.groups;\n      this.grouped = true;\n      this.rootGroupsIndex = subData.groupsIndex;\n    }\n  }, {\n    key: \"treefyData\",\n    value: function treefyData() {\n      var _this6 = this;\n\n      this.sorted = this.paged = false;\n      this.data.forEach(function (a) {\n        return a.tableData.childRows = null;\n      });\n      this.treefiedData = [];\n      this.treefiedDataLength = 0;\n      this.treeDataMaxLevel = 0; // if filter or search is enabled, collapse the tree\n\n      if (this.searchText || this.columns.some(function (columnDef) {\n        return columnDef.tableData.filterValue;\n      })) {\n        this.data.forEach(function (row) {\n          row.tableData.isTreeExpanded = false;\n        }); // expand the tree for all nodes present after filtering and searching\n\n        this.expandTreeForNodes(this.searchedData);\n      }\n\n      var addRow = function addRow(rowData) {\n        rowData.tableData.markedForTreeRemove = false;\n\n        var parent = _this6.parentFunc(rowData, _this6.data);\n\n        if (parent) {\n          parent.tableData.childRows = parent.tableData.childRows || [];\n\n          if (!parent.tableData.childRows.includes(rowData)) {\n            parent.tableData.childRows.push(rowData);\n            _this6.treefiedDataLength++;\n          }\n\n          addRow(parent);\n          rowData.tableData.path = [].concat((0, _toConsumableArray2[\"default\"])(parent.tableData.path), [parent.tableData.childRows.length - 1]);\n          _this6.treeDataMaxLevel = Math.max(_this6.treeDataMaxLevel, rowData.tableData.path.length);\n        } else {\n          if (!_this6.treefiedData.includes(rowData)) {\n            _this6.treefiedData.push(rowData);\n\n            _this6.treefiedDataLength++;\n            rowData.tableData.path = [_this6.treefiedData.length - 1];\n          }\n        }\n      }; // Add all rows initially\n\n\n      this.data.forEach(function (rowData) {\n        addRow(rowData);\n      });\n\n      var markForTreeRemove = function markForTreeRemove(rowData) {\n        var pointer = _this6.treefiedData;\n        rowData.tableData.path.forEach(function (pathPart) {\n          if (pointer.tableData && pointer.tableData.childRows) {\n            pointer = pointer.tableData.childRows;\n          }\n\n          pointer = pointer[pathPart];\n        });\n        pointer.tableData.markedForTreeRemove = true;\n      };\n\n      var traverseChildrenAndUnmark = function traverseChildrenAndUnmark(rowData) {\n        if (rowData.tableData.childRows) {\n          rowData.tableData.childRows.forEach(function (row) {\n            traverseChildrenAndUnmark(row);\n          });\n        }\n\n        rowData.tableData.markedForTreeRemove = false;\n      }; // for all data rows, restore initial expand if no search term is available and remove items that shouldn't be there\n\n\n      this.data.forEach(function (rowData) {\n        if (!_this6.searchText && !_this6.columns.some(function (columnDef) {\n          return columnDef.tableData.filterValue;\n        })) {\n          if (rowData.tableData.isTreeExpanded === undefined) {\n            var isExpanded = typeof _this6.defaultExpanded === \"boolean\" ? _this6.defaultExpanded : _this6.defaultExpanded(rowData);\n            rowData.tableData.isTreeExpanded = isExpanded;\n          }\n        }\n\n        var hasSearchMatchedChildren = rowData.tableData.isTreeExpanded;\n\n        if (!hasSearchMatchedChildren && _this6.searchedData.indexOf(rowData) < 0) {\n          markForTreeRemove(rowData);\n        }\n      }); // preserve all children of nodes that are matched by search or filters\n\n      this.data.forEach(function (rowData) {\n        if (_this6.searchedData.indexOf(rowData) > -1) {\n          traverseChildrenAndUnmark(rowData);\n        }\n      });\n\n      var traverseTreeAndDeleteMarked = function traverseTreeAndDeleteMarked(rowDataArray) {\n        for (var i = rowDataArray.length - 1; i >= 0; i--) {\n          var item = rowDataArray[i];\n\n          if (item.tableData.childRows) {\n            traverseTreeAndDeleteMarked(item.tableData.childRows);\n          }\n\n          if (item.tableData.markedForTreeRemove) rowDataArray.splice(i, 1);\n        }\n      };\n\n      traverseTreeAndDeleteMarked(this.treefiedData);\n      this.treefied = true;\n    }\n  }, {\n    key: \"sortData\",\n    value: function sortData() {\n      var _this7 = this;\n\n      this.paged = false;\n\n      if (this.isDataType(\"group\")) {\n        this.sortedData = (0, _toConsumableArray2[\"default\"])(this.groupedData);\n        var groups = this.columns.filter(function (col) {\n          return col.tableData.groupOrder > -1;\n        }).sort(function (col1, col2) {\n          return col1.tableData.groupOrder - col2.tableData.groupOrder;\n        });\n\n        var sortGroups = function sortGroups(list, columnDef) {\n          if (columnDef.customSort) {\n            return list.sort(columnDef.tableData.groupSort === \"desc\" ? function (a, b) {\n              return columnDef.customSort(b.value, a.value, \"group\");\n            } : function (a, b) {\n              return columnDef.customSort(a.value, b.value, \"group\");\n            });\n          } else {\n            return list.sort(columnDef.tableData.groupSort === \"desc\" ? function (a, b) {\n              return _this7.sort(b.value, a.value, columnDef.type);\n            } : function (a, b) {\n              return _this7.sort(a.value, b.value, columnDef.type);\n            });\n          }\n        };\n\n        this.sortedData = sortGroups(this.sortedData, groups[0]);\n\n        var sortGroupData = function sortGroupData(list, level) {\n          list.forEach(function (element) {\n            if (element.groups.length > 0) {\n              var column = groups[level];\n              element.groups = sortGroups(element.groups, column);\n              sortGroupData(element.groups, level + 1);\n            } else {\n              if (_this7.orderBy >= 0 && _this7.orderDirection) {\n                element.data = _this7.sortList(element.data);\n              }\n            }\n          });\n        };\n\n        sortGroupData(this.sortedData, 1);\n      } else if (this.isDataType(\"tree\")) {\n        this.sortedData = (0, _toConsumableArray2[\"default\"])(this.treefiedData);\n\n        if (this.orderBy != -1) {\n          this.sortedData = this.sortList(this.sortedData);\n\n          var sortTree = function sortTree(list) {\n            list.forEach(function (item) {\n              if (item.tableData.childRows) {\n                item.tableData.childRows = _this7.sortList(item.tableData.childRows);\n                sortTree(item.tableData.childRows);\n              }\n            });\n          };\n\n          sortTree(this.sortedData);\n        }\n      } else if (this.isDataType(\"normal\")) {\n        this.sortedData = (0, _toConsumableArray2[\"default\"])(this.searchedData);\n\n        if (this.orderBy != -1 && this.applySort) {\n          this.sortedData = this.sortList(this.sortedData);\n        }\n      }\n\n      this.sorted = true;\n    }\n  }, {\n    key: \"pageData\",\n    value: function pageData() {\n      this.pagedData = (0, _toConsumableArray2[\"default\"])(this.sortedData);\n\n      if (this.paging) {\n        var startIndex = this.currentPage * this.pageSize;\n        var endIndex = startIndex + this.pageSize;\n        this.pagedData = this.pagedData.slice(startIndex, endIndex);\n      }\n\n      this.paged = true;\n    }\n  }]);\n  return DataManager;\n}();\n\nexports[\"default\"] = DataManager;"]},"metadata":{},"sourceType":"script"}