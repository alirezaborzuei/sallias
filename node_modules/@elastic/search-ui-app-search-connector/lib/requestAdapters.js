"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.adaptRequest = adaptRequest;

var _defineProperty2 = _interopRequireDefault(require("@babel/runtime/helpers/defineProperty"));

var _objectWithoutProperties2 = _interopRequireDefault(require("@babel/runtime/helpers/objectWithoutProperties"));

function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { (0, _defineProperty2.default)(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }

function removeName(v) {
  if (v && v.name) {
    // eslint-disable-next-line
    var name = v.name,
        rest = (0, _objectWithoutProperties2.default)(v, ["name"]);
    return _objectSpread({}, rest);
  }

  return v;
}

function rollup(f) {
  var values = f.values.map(removeName).map(function (v) {
    return (0, _defineProperty2.default)({}, f.field, v);
  });
  return (0, _defineProperty2.default)({}, f.type || "any", values);
}

function adaptFilters(filters) {
  if (!filters || filters.length === 0) return {};
  var all = filters.map(rollup);
  return {
    all: all
  };
}

function adaptRequest(request) {
  var current = request.current,
      resultsPerPage = request.resultsPerPage,
      searchTerm = request.searchTerm,
      sortDirection = request.sortDirection,
      sortField = request.sortField;
  var sort = sortField && sortDirection ? (0, _defineProperty2.default)({}, sortField, sortDirection) : undefined;
  return _objectSpread(_objectSpread({
    query: searchTerm
  }, sort !== undefined && {
    sort: sort
  }), {}, {
    page: _objectSpread(_objectSpread({}, resultsPerPage !== undefined && {
      size: resultsPerPage
    }), current !== undefined && {
      current: current
    }),
    filters: adaptFilters(request.filters)
  });
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9yZXF1ZXN0QWRhcHRlcnMuanMiXSwibmFtZXMiOlsicmVtb3ZlTmFtZSIsInYiLCJuYW1lIiwicmVzdCIsInJvbGx1cCIsImYiLCJ2YWx1ZXMiLCJtYXAiLCJmaWVsZCIsInR5cGUiLCJhZGFwdEZpbHRlcnMiLCJmaWx0ZXJzIiwibGVuZ3RoIiwiYWxsIiwiYWRhcHRSZXF1ZXN0IiwicmVxdWVzdCIsImN1cnJlbnQiLCJyZXN1bHRzUGVyUGFnZSIsInNlYXJjaFRlcm0iLCJzb3J0RGlyZWN0aW9uIiwic29ydEZpZWxkIiwic29ydCIsInVuZGVmaW5lZCIsInF1ZXJ5IiwicGFnZSIsInNpemUiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUEsU0FBU0EsVUFBVCxDQUFvQkMsQ0FBcEIsRUFBdUI7QUFDckIsTUFBSUEsQ0FBQyxJQUFJQSxDQUFDLENBQUNDLElBQVgsRUFBaUI7QUFDZjtBQURlLFFBRVBBLElBRk8sR0FFV0QsQ0FGWCxDQUVQQyxJQUZPO0FBQUEsUUFFRUMsSUFGRiwwQ0FFV0YsQ0FGWDtBQUdmLDZCQUNLRSxJQURMO0FBR0Q7O0FBRUQsU0FBT0YsQ0FBUDtBQUNEOztBQUVELFNBQVNHLE1BQVQsQ0FBZ0JDLENBQWhCLEVBQW1CO0FBQ2pCLE1BQU1DLE1BQU0sR0FBR0QsQ0FBQyxDQUFDQyxNQUFGLENBQVNDLEdBQVQsQ0FBYVAsVUFBYixFQUF5Qk8sR0FBekIsQ0FBNkIsVUFBQU4sQ0FBQztBQUFBLDZDQUMxQ0ksQ0FBQyxDQUFDRyxLQUR3QyxFQUNoQ1AsQ0FEZ0M7QUFBQSxHQUE5QixDQUFmO0FBSUEsMkNBQ0dJLENBQUMsQ0FBQ0ksSUFBRixJQUFVLEtBRGIsRUFDcUJILE1BRHJCO0FBR0Q7O0FBRUQsU0FBU0ksWUFBVCxDQUFzQkMsT0FBdEIsRUFBK0I7QUFDN0IsTUFBSSxDQUFDQSxPQUFELElBQVlBLE9BQU8sQ0FBQ0MsTUFBUixLQUFtQixDQUFuQyxFQUFzQyxPQUFPLEVBQVA7QUFDdEMsTUFBTUMsR0FBRyxHQUFHRixPQUFPLENBQUNKLEdBQVIsQ0FBWUgsTUFBWixDQUFaO0FBQ0EsU0FBTztBQUNMUyxJQUFBQSxHQUFHLEVBQUhBO0FBREssR0FBUDtBQUdEOztBQUVNLFNBQVNDLFlBQVQsQ0FBc0JDLE9BQXRCLEVBQStCO0FBQUEsTUFFbENDLE9BRmtDLEdBT2hDRCxPQVBnQyxDQUVsQ0MsT0FGa0M7QUFBQSxNQUdsQ0MsY0FIa0MsR0FPaENGLE9BUGdDLENBR2xDRSxjQUhrQztBQUFBLE1BSWxDQyxVQUprQyxHQU9oQ0gsT0FQZ0MsQ0FJbENHLFVBSmtDO0FBQUEsTUFLbENDLGFBTGtDLEdBT2hDSixPQVBnQyxDQUtsQ0ksYUFMa0M7QUFBQSxNQU1sQ0MsU0FOa0MsR0FPaENMLE9BUGdDLENBTWxDSyxTQU5rQztBQVNwQyxNQUFNQyxJQUFJLEdBQ1JELFNBQVMsSUFBSUQsYUFBYixxQ0FFT0MsU0FGUCxFQUVtQkQsYUFGbkIsSUFJSUcsU0FMTjtBQU9BO0FBQ0VDLElBQUFBLEtBQUssRUFBRUw7QUFEVCxLQUVNRyxJQUFJLEtBQUtDLFNBQVQsSUFBc0I7QUFBRUQsSUFBQUEsSUFBSSxFQUFKQTtBQUFGLEdBRjVCO0FBR0VHLElBQUFBLElBQUksa0NBQ0VQLGNBQWMsS0FBS0ssU0FBbkIsSUFBZ0M7QUFBRUcsTUFBQUEsSUFBSSxFQUFFUjtBQUFSLEtBRGxDLEdBRUVELE9BQU8sS0FBS00sU0FBWixJQUF5QjtBQUFFTixNQUFBQSxPQUFPLEVBQVBBO0FBQUYsS0FGM0IsQ0FITjtBQU9FTCxJQUFBQSxPQUFPLEVBQUVELFlBQVksQ0FBQ0ssT0FBTyxDQUFDSixPQUFUO0FBUHZCO0FBU0QiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiByZW1vdmVOYW1lKHYpIHtcbiAgaWYgKHYgJiYgdi5uYW1lKSB7XG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lXG4gICAgY29uc3QgeyBuYW1lLCAuLi5yZXN0IH0gPSB2O1xuICAgIHJldHVybiB7XG4gICAgICAuLi5yZXN0XG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB2O1xufVxuXG5mdW5jdGlvbiByb2xsdXAoZikge1xuICBjb25zdCB2YWx1ZXMgPSBmLnZhbHVlcy5tYXAocmVtb3ZlTmFtZSkubWFwKHYgPT4gKHtcbiAgICBbZi5maWVsZF06IHZcbiAgfSkpO1xuXG4gIHJldHVybiB7XG4gICAgW2YudHlwZSB8fCBcImFueVwiXTogdmFsdWVzXG4gIH07XG59XG5cbmZ1bmN0aW9uIGFkYXB0RmlsdGVycyhmaWx0ZXJzKSB7XG4gIGlmICghZmlsdGVycyB8fCBmaWx0ZXJzLmxlbmd0aCA9PT0gMCkgcmV0dXJuIHt9O1xuICBjb25zdCBhbGwgPSBmaWx0ZXJzLm1hcChyb2xsdXApO1xuICByZXR1cm4ge1xuICAgIGFsbFxuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYWRhcHRSZXF1ZXN0KHJlcXVlc3QpIHtcbiAgY29uc3Qge1xuICAgIGN1cnJlbnQsXG4gICAgcmVzdWx0c1BlclBhZ2UsXG4gICAgc2VhcmNoVGVybSxcbiAgICBzb3J0RGlyZWN0aW9uLFxuICAgIHNvcnRGaWVsZFxuICB9ID0gcmVxdWVzdDtcblxuICBjb25zdCBzb3J0ID1cbiAgICBzb3J0RmllbGQgJiYgc29ydERpcmVjdGlvblxuICAgICAgPyB7XG4gICAgICAgICAgW3NvcnRGaWVsZF06IHNvcnREaXJlY3Rpb25cbiAgICAgICAgfVxuICAgICAgOiB1bmRlZmluZWQ7XG5cbiAgcmV0dXJuIHtcbiAgICBxdWVyeTogc2VhcmNoVGVybSxcbiAgICAuLi4oc29ydCAhPT0gdW5kZWZpbmVkICYmIHsgc29ydCB9KSxcbiAgICBwYWdlOiB7XG4gICAgICAuLi4ocmVzdWx0c1BlclBhZ2UgIT09IHVuZGVmaW5lZCAmJiB7IHNpemU6IHJlc3VsdHNQZXJQYWdlIH0pLFxuICAgICAgLi4uKGN1cnJlbnQgIT09IHVuZGVmaW5lZCAmJiB7IGN1cnJlbnQgfSlcbiAgICB9LFxuICAgIGZpbHRlcnM6IGFkYXB0RmlsdGVycyhyZXF1ZXN0LmZpbHRlcnMpXG4gIH07XG59XG4iXX0=